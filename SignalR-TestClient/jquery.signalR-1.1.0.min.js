/*!
 * ASP.NET SignalR JavaScript Library v1.1.0
 * http://signalr.net/
 *
 * Copyright Microsoft Open Technologies, Inc. All rights reserved.
 * Licensed under the Apache 2.0
 * https://github.com/SignalR/SignalR/blob/master/LICENSE.md
 *
 */
(function(h,i){if(typeof(h)!=="function"){throw new Error("SignalR: jQuery not found. Please ensure jQuery is referenced before the SignalR.js file.")}if(!i.JSON){throw new Error("SignalR: No JSON parser found. Please ensure json2.js is referenced before the SignalR.js file if you need to support clients without native JSON parsing support, e.g. IE<8.")}var k,g,a=(i.document.readyState==="complete"),d=h(i),n={onStart:"onStart",onStarting:"onStarting",onReceived:"onReceived",onError:"onError",onConnectionSlow:"onConnectionSlow",onReconnecting:"onReconnecting",onReconnect:"onReconnect",onStateChanged:"onStateChanged",onDisconnect:"onDisconnect"},f=function(q,p){if(p===false){return}var o;if(typeof(i.console)==="undefined"){return}o="["+new Date().toTimeString()+"] SignalR: "+q;if(i.console.debug){i.console.debug(o)}else{if(i.console.log){i.console.log(o)}}},l=function(p,o,q){if(o===p.state){p.state=q;h(p).triggerHandler(n.onStateChanged,[{oldState:o,newState:q}]);return true}return false},c=function(o){return o.state===k.connectionState.disconnected},j=function(p){var o,q;if(!p._.configuredStopReconnectingTimeout){q=function(r){r.log("Couldn't reconnect within the configured timeout ("+r.disconnectTimeout+"ms), disconnecting.");r.stop(false,false)};p.reconnecting(function(){var r=this;if(r.state===k.connectionState.reconnecting){o=i.setTimeout(function(){q(r)},r.disconnectTimeout)}});p.stateChanged(function(r){if(r.oldState===k.connectionState.reconnecting){i.clearTimeout(o)}});p._.configuredStopReconnectingTimeout=true}};k=function(p,o,q){return new k.fn.init(p,o,q)};k._={defaultContentType:"application/x-www-form-urlencoded; charset=UTF-8",ieVersion:(function(){var o,p;if(i.navigator.appName==="Microsoft Internet Explorer"){p=/MSIE ([0-9]+\.[0-9]+)/.exec(i.navigator.userAgent);if(p){o=i.parseFloat(p[1])}}return o})()};k.events=n;k.changeState=l;k.isDisconnecting=c;k.connectionState={connecting:0,connected:1,reconnecting:2,disconnected:4};k.hub={start:function(){throw new Error("SignalR: Error loading hubs. Ensure your hubs reference is correct, e.g. <script src='/signalr/hubs'><\/script>.")}};d.load(function(){a=true});function m(o,p){if(h.isArray(o)){for(var q=o.length-1;q>=0;q--){var r=o[q];if(h.type(o)!=="object"&&(h.type(r)!=="string"||!k.transports[r])){p.log("Invalid transport: "+r+", removing it from the transports list.");o.splice(q,1)}}if(o.length===0){p.log("No transports remain within the specified transport array.");o=null}}else{if(h.type(o)!=="object"&&!k.transports[o]&&o!=="auto"){p.log("Invalid transport: "+o.toString());o=null}else{if(o==="auto"&&k._.ieVersion<=8){return["longPolling"]}}}return o}function b(o){if(o==="http:"){return 80}else{if(o==="https:"){return 443}}}function e(p,o){if(o.match(/:\d+$/)){return o}else{return o+":"+b(p)}}k.fn=k.prototype={init:function(p,o,q){this.url=p;this.qs=o;this._={};if(typeof(q)==="boolean"){this.logging=q}},isCrossDomain:function(p,o){var q;p=h.trim(p);if(p.indexOf("http")!==0){return false}o=o||i.location;q=i.document.createElement("a");q.href=p;return q.protocol+e(q.protocol,q.host)!==o.protocol+e(o.protocol,o.host)},ajaxDataType:"json",contentType:"application/json; charset=UTF-8",logging:false,state:k.connectionState.disconnected,keepAliveData:{},reconnectDelay:2000,disconnectTimeout:30000,keepAliveWarnAt:2/3,start:function(t,v){var q=this,s={waitForPageLoad:true,transport:"auto",jsonp:false},o,p=q._deferral||h.Deferred(),u=i.document.createElement("a");if(h.type(t)==="function"){v=t}else{if(h.type(t)==="object"){h.extend(s,t);if(h.type(s.callback)==="function"){v=s.callback}}}s.transport=m(s.transport,q);if(!s.transport){throw new Error("SignalR: Invalid transport(s) specified, aborting start.")}if(!a&&s.waitForPageLoad===true){d.load(function(){q._deferral=p;q.start(t,v)});return p.promise()}j(q);if(l(q,k.connectionState.disconnected,k.connectionState.connecting)===false){p.resolve(q);return p.promise()}u.href=q.url;if(!u.protocol||u.protocol===":"){q.protocol=i.document.location.protocol;q.host=i.document.location.host;q.baseUrl=q.protocol+"//"+q.host}else{q.protocol=u.protocol;q.host=u.host;q.baseUrl=u.protocol+"//"+u.host}q.wsProtocol=q.protocol==="https:"?"wss://":"ws://";if(s.transport==="auto"&&s.jsonp===true){s.transport="longPolling"}if(this.isCrossDomain(q.url)){q.log("Auto detected cross domain url.");if(s.transport==="auto"){s.transport=["webSockets","longPolling"]}if(!s.jsonp){s.jsonp=!h.support.cors;if(s.jsonp){q.log("Using jsonp because this browser doesn't support CORS")}}q.contentType=k._.defaultContentType}q.ajaxDataType=s.jsonp?"jsonp":"json";h(q).bind(n.onStart,function(x,w){if(h.type(v)==="function"){v.call(q)}p.resolve(q)});o=function(w,x){x=x||0;if(x>=w.length){if(!q.transport){h(q).triggerHandler(n.onError,["SignalR: No transport could be initialized successfully. Try specifying a different transport or none at all for auto initialization."]);p.reject("SignalR: No transport could be initialized successfully. Try specifying a different transport or none at all for auto initialization.");q.stop()}return}var y=w[x],z=h.type(y)==="object"?y:k.transports[y];if(y.indexOf("_")===0){o(w,x+1);return}z.start(q,function(){if(z.supportsKeepAlive&&q.keepAliveData.activated){k.transports._logic.monitorKeepAlive(q)}q.transport=z;l(q,k.connectionState.connecting,k.connectionState.connected);h(q).triggerHandler(n.onStart);d.unload(function(){q.stop(false)})},function(){o(w,x+1)})};var r=q.url+"/negotiate";r=k.transports._logic.addQs(r,q);q.log("Negotiating with '"+r+"'.");h.ajax({url:r,global:false,cache:false,type:"GET",contentType:q.contentType,data:{},dataType:q.ajaxDataType,error:function(w){h(q).triggerHandler(n.onError,[w.responseText]);p.reject("SignalR: Error during negotiation request: "+w.responseText);q.stop()},success:function(y){var x=q.keepAliveData;q.appRelativeUrl=y.Url;q.id=y.ConnectionId;q.token=y.ConnectionToken;q.webSocketServerUrl=y.WebSocketServerUrl;q.disconnectTimeout=y.DisconnectTimeout*1000;if(y.KeepAliveTimeout){x.activated=true;x.timeout=y.KeepAliveTimeout*1000;x.timeoutWarning=x.timeout*q.keepAliveWarnAt;x.checkInterval=(x.timeout-x.timeoutWarning)/3}else{x.activated=false}if(!y.ProtocolVersion||y.ProtocolVersion!=="1.2"){h(q).triggerHandler(n.onError,["You are using a version of the client that isn't compatible with the server. Client version 1.2, server version "+y.ProtocolVersion+"."]);p.reject("You are using a version of the client that isn't compatible with the server. Client version 1.2, server version "+y.ProtocolVersion+".");return}h(q).triggerHandler(n.onStarting);var w=[],z=[];h.each(k.transports,function(A){if(A==="webSockets"&&!y.TryWebSockets){return true}z.push(A)});if(h.isArray(s.transport)){h.each(s.transport,function(){var A=this;if(h.type(A)==="object"||(h.type(A)==="string"&&h.inArray(""+A,z)>=0)){w.push(h.type(A)==="string"?""+A:A)}})}else{if(h.type(s.transport)==="object"||h.inArray(s.transport,z)>=0){w.push(s.transport)}else{w=z}}o(w)}});return p.promise()},starting:function(p){var o=this;h(o).bind(n.onStarting,function(r,q){p.call(o)});return o},send:function(p){var o=this;if(o.state===k.connectionState.disconnected){throw new Error("SignalR: Connection must be started before data can be sent. Call .start() before .send()")}if(o.state===k.connectionState.connecting){throw new Error("SignalR: Connection has not been fully initialized. Use .start().done() or .start().fail() to run logic after the connection has started.")}o.transport.send(o,p);return o},received:function(p){var o=this;h(o).bind(n.onReceived,function(r,q){p.call(o,q)});return o},stateChanged:function(p){var o=this;h(o).bind(n.onStateChanged,function(r,q){p.call(o,q)});return o},error:function(p){var o=this;h(o).bind(n.onError,function(r,q){p.call(o,q)});return o},disconnected:function(p){var o=this;h(o).bind(n.onDisconnect,function(r,q){p.call(o)});return o},connectionSlow:function(p){var o=this;h(o).bind(n.onConnectionSlow,function(r,q){p.call(o)});return o},reconnecting:function(p){var o=this;h(o).bind(n.onReconnecting,function(r,q){p.call(o)});return o},reconnected:function(p){var o=this;h(o).bind(n.onReconnect,function(r,q){p.call(o)});return o},stop:function(q,o){var p=this;if(p.state===k.connectionState.disconnected){return}try{if(p.transport){if(o!==false){p.transport.abort(p,q)}if(p.transport.supportsKeepAlive&&p.keepAliveData.activated){k.transports._logic.stopMonitoringKeepAlive(p)}p.transport.stop(p);p.transport=null}h(p).triggerHandler(n.onDisconnect);delete p.messageId;delete p.groupsToken;delete p.id;delete p._deferral}finally{l(p,p.state,k.connectionState.disconnected)}return p},log:function(o){f(o,this.logging)}};k.fn.init.prototype=k.fn;k.noConflict=function(){if(h.connection===k){h.connection=g}return k};if(h.connection){g=h.connection}h.connection=h.signalR=k}(window.jQuery,window));(function(g,h){var a=0,i={},j=".hubProxy";function e(l){return l+j}function c(m,n,p){var o,q=m.length,l=[];for(o=0;o<q;o+=1){if(m.hasOwnProperty(o)){l[o]=n.call(p,m[o],o,m)}}return l}function d(l){return g.isFunction(l)?null:(g.type(l)==="undefined"?null:l)}function b(m){for(var l in m){if(m.hasOwnProperty(l)){return true}}return false}function f(m,l){return new f.fn.init(m,l)}f.fn=f.prototype={init:function(l,m){this.state={};this.connection=l;this.hubName=m;this._={callbackMap:{}}},hasSubscriptions:function(){return b(this._.callbackMap)},on:function(m,o){var l=this,n=l._.callbackMap;m=m.toLowerCase();if(!n[m]){n[m]={}}n[m][o]=function(q,p){o.apply(l,p)};g(l).bind(e(m),n[m][o]);return l},off:function(n,p){var m=this,o=m._.callbackMap,l;n=n.toLowerCase();l=o[n];if(l){if(l[p]){g(m).unbind(e(n),l[p]);delete l[p];if(!b(l)){delete o[n]}}else{if(!p){g(m).unbind(e(n));delete o[n]}}}return m},invoke:function(m){var l=this,n=g.makeArray(arguments).slice(1),o=c(n,d),p={H:l.hubName,M:m,A:o,I:a},q=g.Deferred(),r=function(t){var s=l._maximizeHubResponse(t);g.extend(l.state,s.State);if(s.Error){if(s.StackTrace){l.connection.log(s.Error+"\n"+s.StackTrace)}q.rejectWith(l,[s.Error])}else{q.resolveWith(l,[s.Result])}};i[a.toString()]={scope:l,method:r};a+=1;if(!g.isEmptyObject(l.state)){p.S=l.state}l.connection.send(h.JSON.stringify(p));return q.promise()},_maximizeHubResponse:function(l){return{State:l.S,Result:l.R,Id:l.I,Error:l.E,StackTrace:l.T}}};f.fn.init.prototype=f.fn;function k(m,l){var n={qs:null,logging:false,useDefaultPath:true};g.extend(n,l);if(!m||n.useDefaultPath){m=(m||"")+"/signalr"}return new k.fn.init(m,n)}k.fn=k.prototype=g.connection();k.fn.init=function(n,m){var o={qs:null,logging:false,useDefaultPath:true},l=this;g.extend(o,m);g.signalR.fn.init.call(l,n,o.qs,o.logging);l.proxies={};l.received(function(p){var t,s,q,v,u,r;if(!p){return}if(typeof(p.I)!=="undefined"){q=p.I.toString();v=i[q];if(v){i[q]=null;delete i[q];v.method.call(v.scope,p)}}else{t=this._maximizeClientHubInvocation(p);l.log("Triggering client hub event '"+t.Method+"' on hub '"+t.Hub+"'.");u=t.Hub.toLowerCase();r=t.Method.toLowerCase();s=this.proxies[u];g.extend(s.state,t.State);g(s).triggerHandler(e(r),[t.Args])}})};k.fn._maximizeClientHubInvocation=function(l){return{Hub:l.H,Method:l.M,Args:l.A,State:l.S}};k.fn._registerSubscribedHubs=function(){if(!this._subscribedToHubs){this._subscribedToHubs=true;this.starting(function(){var l=[];g.each(this.proxies,function(m){if(this.hasSubscriptions()){l.push({name:m})}});this.data=h.JSON.stringify(l)})}};k.fn.createHubProxy=function(m){m=m.toLowerCase();var l=this.proxies[m];if(!l){l=f(this,m);this.proxies[m]=l}this._registerSubscribedHubs();return l};k.fn.init.prototype=k.fn;g.hubConnection=k}(window.jQuery,window));(function(f,e){var a=f.signalR,c=f.signalR.events,d=f.signalR.changeState;a.transports={};function g(h){var i=h.keepAliveData,k,j;if(h.state===a.connectionState.connected){k=new Date();k.setTime(k-i.lastKeepAlive);j=k.getTime();if(j>=i.timeout){h.log("Keep alive timed out.  Notifying transport that connection has been lost.");h.transport.lostConnection(h)}else{if(j>=i.timeoutWarning){if(!i.userNotified){h.log("Keep alive has been missed, connection may be dead/slow.");f(h).triggerHandler(c.onConnectionSlow);i.userNotified=true}}else{i.userNotified=false}}}if(i.monitoring){e.setTimeout(function(){g(h)},i.checkInterval)}}function b(h){return h.state===a.connectionState.connected||h.state===a.connectionState.reconnecting}a.transports._logic={pingServer:function(h,l){var j=l==="webSockets"?"":h.baseUrl,i=j+h.appRelativeUrl+"/ping",k=f.Deferred();i=this.addQs(i,h);f.ajax({url:i,global:false,cache:false,type:"GET",contentType:h.contentType,data:{},dataType:h.ajaxDataType,success:function(m){if(m.Response==="pong"){k.resolve()}else{k.reject("SignalR: Invalid ping response when pinging server: "+(m.responseText||m.statusText))}},error:function(m){k.reject("SignalR: Error pinging server: "+(m.responseText||m.statusText))}});return k.promise()},addQs:function(j,i){var h=j.indexOf("?")!==-1?"&":"?",k;if(!i.qs){return j}if(typeof(i.qs)==="object"){return j+h+f.param(i.qs)}if(typeof(i.qs)==="string"){k=i.qs.charAt(0);if(k==="?"||k==="&"){h=""}return j+h+i.qs}throw new Error("Connections query string property must be either a string or object.")},getUrl:function(i,n,m,l){var k=n==="webSockets"?"":i.baseUrl,j=k+i.appRelativeUrl,h="transport="+n+"&connectionToken="+e.encodeURIComponent(i.token);if(i.data){h+="&connectionData="+e.encodeURIComponent(i.data)}if(i.groupsToken){h+="&groupsToken="+e.encodeURIComponent(i.groupsToken)}if(!m){j+="/connect"}else{if(l){j+="/poll"}else{j+="/reconnect"}if(i.messageId){h+="&messageId="+e.encodeURIComponent(i.messageId)}}j+="?"+h;j=this.addQs(j,i);j+="&tid="+Math.floor(Math.random()*11);return j},maximizePersistentResponse:function(h){return{MessageId:h.C,Messages:h.M,Disconnect:typeof(h.D)!=="undefined"?true:false,TimedOut:typeof(h.T)!=="undefined"?true:false,LongPollDelay:h.L,GroupsToken:h.G}},updateGroups:function(i,h){if(h){i.groupsToken=h}},ajaxSend:function(h,j){var i=h.url+"/send?transport="+h.transport.name+"&connectionToken="+e.encodeURIComponent(h.token);i=this.addQs(i,h);return f.ajax({url:i,global:false,type:h.ajaxDataType==="jsonp"?"GET":"POST",contentType:a._.defaultContentType,dataType:h.ajaxDataType,data:{data:j},success:function(k){if(k){f(h).triggerHandler(c.onReceived,[k])}},error:function(k,l){if(l==="abort"||l==="parsererror"){return}f(h).triggerHandler(c.onError,[k])}})},ajaxAbort:function(h,j){if(typeof(h.transport)==="undefined"){return}j=typeof j==="undefined"?true:j;var i=h.url+"/abort?transport="+h.transport.name+"&connectionToken="+e.encodeURIComponent(h.token);i=this.addQs(i,h);f.ajax({url:i,async:j,timeout:1000,global:false,type:"POST",contentType:h.contentType,dataType:h.ajaxDataType,data:{}});h.log("Fired ajax abort async = "+j)},processMessages:function(j,h){var k;if(j.transport){var i=f(j);if(j.transport.supportsKeepAlive&&j.keepAliveData.activated){this.updateKeepAlive(j)}if(!h){return}k=this.maximizePersistentResponse(h);if(k.Disconnect){j.log("Disconnect command received from server");j.stop(false,false);return}this.updateGroups(j,k.GroupsToken);if(k.Messages){f.each(k.Messages,function(l,m){i.triggerHandler(c.onReceived,[m])})}if(k.MessageId){j.messageId=k.MessageId}}},monitorKeepAlive:function(h){var i=h.keepAliveData,j=this;if(!i.monitoring){i.monitoring=true;j.updateKeepAlive(h);h.keepAliveData.reconnectKeepAliveUpdate=function(){j.updateKeepAlive(h)};f(h).bind(c.onReconnect,h.keepAliveData.reconnectKeepAliveUpdate);h.log("Now monitoring keep alive with a warning timeout of "+i.timeoutWarning+" and a connection lost timeout of "+i.timeout);g(h)}else{h.log("Tried to monitor keep alive but it's already being monitored")}},stopMonitoringKeepAlive:function(h){var i=h.keepAliveData;if(i.monitoring){i.monitoring=false;f(h).unbind(c.onReconnect,h.keepAliveData.reconnectKeepAliveUpdate);h.keepAliveData={};h.log("Stopping the monitoring of the keep alive")}},updateKeepAlive:function(h){h.keepAliveData.lastKeepAlive=new Date()},ensureReconnectingState:function(h){if(d(h,a.connectionState.connected,a.connectionState.reconnecting)===true){f(h).triggerHandler(c.onReconnecting)}return h.state===a.connectionState.reconnecting},clearReconnectTimeout:function(h){if(h&&h._.reconnectTimeout){e.clearTimeout(h._.reconnectTimeout);delete h._.reconnectTimeout}},reconnect:function(h,j){var k=a.transports[j],i=this;if(b(h)&&!h._.reconnectTimeout){h._.reconnectTimeout=e.setTimeout(function(){k.stop(h);if(i.ensureReconnectingState(h)){h.log(j+" reconnecting");k.start(h)}},h.reconnectDelay)}},foreverFrame:{count:0,connections:{}}}}(window.jQuery,window));(function(e,d){var a=e.signalR,b=e.signalR.events,c=e.signalR.changeState,f=a.transports._logic,g=(function(){var j=null,i=1000,h=0;return{prevent:function(){if(a._.ieVersion<=8){if(h===0){j=d.setInterval(function(){var k=e("<iframe style='position:absolute;top:0;left:0;width:0;height:0;visibility:hidden;' src=''></iframe>");e("body").append(k);k.remove();k=null},i)}h++}},cancel:function(){if(h===1){d.clearInterval(j)}if(h>0){h--}}}})();a.transports.foreverFrame={name:"foreverFrame",supportsKeepAlive:true,timeOut:3000,start:function(h,n,j){var l=this,k=(f.foreverFrame.count+=1),i,m=e("<iframe data-signalr-connection-id='"+h.id+"' style='position:absolute;top:0;left:0;width:0;height:0;visibility:hidden;' src=''></iframe>");if(d.EventSource){if(j){h.log("This browser supports SSE, skipping Forever Frame.");j()}return}g.prevent();i=f.getUrl(h,this.name);i+="&frameId="+k;e("body").append(m);m.prop("src",i);f.foreverFrame.connections[k]=h;h.log("Binding to iframe's readystatechange event.");m.bind("readystatechange",function(){if(e.inArray(this.readyState,["loaded","complete"])>=0){h.log("Forever frame iframe readyState changed to "+this.readyState+", reconnecting");l.reconnect(h)}});h.frame=m[0];h.frameId=k;if(n){h.onSuccess=n}d.setTimeout(function(){if(h.onSuccess){h.log("Failed to connect using forever frame source, it timed out after "+l.timeOut+"ms.");l.stop(h);if(j){j()}}},l.timeOut)},reconnect:function(h){var i=this;d.setTimeout(function(){if(h.frame&&f.ensureReconnectingState(h)){var k=h.frame,j=f.getUrl(h,i.name,true)+"&frameId="+h.frameId;h.log("Updating iframe src to '"+j+"'.");k.src=j}},h.reconnectDelay)},lostConnection:function(h){this.reconnect(h)},send:function(h,i){f.ajaxSend(h,i)},receive:function(i,j){var h;f.processMessages(i,j);i.frameMessageCount=(i.frameMessageCount||0)+1;if(i.frameMessageCount>50){i.frameMessageCount=0;h=i.frame.contentWindow||i.frame.contentDocument;if(h&&h.document){e("body",h.document).empty()}}},stop:function(i){var h=null;g.cancel();if(i.frame){if(i.frame.stop){i.frame.stop()}else{try{h=i.frame.contentWindow||i.frame.contentDocument;if(h.document&&h.document.execCommand){h.document.execCommand("Stop")}}catch(j){i.log("SignalR: Error occured when stopping foreverFrame transport. Message = "+j.message)}}e(i.frame).remove();delete f.foreverFrame.connections[i.frameId];i.frame=null;i.frameId=null;delete i.frame;delete i.frameId;i.log("Stopping forever frame")}},abort:function(h,i){f.ajaxAbort(h,i)},getConnection:function(h){return f.foreverFrame.connections[h]},started:function(h){if(h.onSuccess){h.onSuccess();h.onSuccess=null;delete h.onSuccess}else{if(c(h,a.connectionState.reconnecting,a.connectionState.connected)===true){e(h).triggerHandler(b.onReconnect)}}}}}(window.jQuery,window));(function(f,e){var a=f.signalR,c=f.signalR.events,d=f.signalR.changeState,b=f.signalR.isDisconnecting,g=a.transports._logic;a.transports.longPolling={name:"longPolling",supportsKeepAlive:false,reconnectDelay:3000,init:function(h,l){var k=this,j,i=function(m){if(b(h)===false){h.log("SignalR: Server ping failed because '"+m+"', re-trying ping.");e.setTimeout(j,k.reconnectDelay)}};h.log("SignalR: Initializing long polling connection with server.");j=function(){g.pingServer(h,k.name).done(l).fail(i)};j()},start:function(h,n,k){var m=this,o=false,j=function(){if(o){return}o=true;n();h.log("Longpolling connected")},p=0,q=null,l=function(r){e.clearTimeout(q);q=null;if(d(h,a.connectionState.reconnecting,a.connectionState.connected)===true){h.log("Raising the reconnect event");f(r).triggerHandler(c.onReconnect)}},i=3600000;if(h.pollXhr){h.log("Polling xhr requests already exists, aborting.");h.stop()}m.init(h,function(){h.messageId=null;e.setTimeout(function(){(function r(s,x){var v=s.messageId,t=(v===null),y=!t,w=!x,u=g.getUrl(s,m.name,y,w);if(b(s)===true){return}h.log("Attempting to connect to '"+u+"' using longPolling.");s.pollXhr=f.ajax({url:u,global:false,cache:false,type:"GET",dataType:h.ajaxDataType,contentType:h.contentType,success:function(z){var A=0,B;p=0;if(q!==null){l()}j();if(z){B=g.maximizePersistentResponse(z)}g.processMessages(s,z);if(B&&f.type(B.LongPollDelay)==="number"){A=B.LongPollDelay}if(B&&B.Disconnect){return}if(b(s)===true){return}if(A>0){e.setTimeout(function(){r(s,false)},A)}else{r(s,false)}},error:function(z,A){e.clearTimeout(q);q=null;if(A==="abort"){h.log("Aborted xhr requst.");return}p++;if(h.state!==a.connectionState.reconnecting){h.log("An error occurred using longPolling. Status = "+A+". "+z.responseText);f(s).triggerHandler(c.onError,[z.responseText])}g.ensureReconnectingState(s);m.init(s,function(){r(s,true)})}});if(y&&x===true){q=e.setTimeout(function(){l(s)},Math.min(1000*(Math.pow(2,p)-1),i))}}(h));e.setTimeout(function(){j()},250)},250)})},lostConnection:function(h){throw new Error("Lost Connection not handled for LongPolling")},send:function(h,i){g.ajaxSend(h,i)},stop:function(h){if(h.pollXhr){h.pollXhr.abort();h.pollXhr=null;delete h.pollXhr}},abort:function(h,i){g.ajaxAbort(h,i)}}}(window.jQuery,window));(function(e,d){var a=e.signalR,b=e.signalR.events,c=e.signalR.changeState,f=a.transports._logic;a.transports.serverSentEvents={name:"serverSentEvents",supportsKeepAlive:true,timeOut:3000,start:function(h,n,j){var l=this,k=false,o=e(h),i=!n,g,p;if(h.eventSource){h.log("The connection already has an event source. Stopping it.");h.stop()}if(!d.EventSource){if(j){h.log("This browser doesn't support SSE.");j()}return}g=f.getUrl(h,this.name,i);try{h.log("Attempting to connect to SSE endpoint '"+g+"'");h.eventSource=new d.EventSource(g)}catch(m){h.log("EventSource failed trying to connect with error "+m.Message);if(j){j()}else{o.triggerHandler(b.onError,[m]);if(i){l.reconnect(h)}}return}p=d.setTimeout(function(){if(k===false){h.log("EventSource timed out trying to connect");h.log("EventSource readyState: "+h.eventSource.readyState);if(!i){l.stop(h)}if(i){if(h.eventSource.readyState!==d.EventSource.CONNECTING&&h.eventSource.readyState!==d.EventSource.OPEN){l.reconnect(h)}}else{if(j){j()}}}},l.timeOut);h.eventSource.addEventListener("open",function(q){h.log("EventSource connected");if(p){d.clearTimeout(p)}f.clearReconnectTimeout(h);if(k===false){k=true;if(n){n()}else{if(c(h,a.connectionState.reconnecting,a.connectionState.connected)===true){o.triggerHandler(b.onReconnect)}}}},false);h.eventSource.addEventListener("message",function(q){if(q.data==="initialized"){return}f.processMessages(h,d.JSON.parse(q.data))},false);h.eventSource.addEventListener("error",function(q){if(this===h.eventSource){if(!k){if(j){j()}return}h.log("EventSource readyState: "+h.eventSource.readyState);if(q.eventPhase===d.EventSource.CLOSED){h.log("EventSource reconnecting due to the server connection ending");l.reconnect(h)}else{h.log("EventSource error");o.triggerHandler(b.onError)}}},false)},reconnect:function(g){f.reconnect(g,this.name)},lostConnection:function(g){this.reconnect(g)},send:function(g,h){f.ajaxSend(g,h)},stop:function(g){f.clearReconnectTimeout(g);if(g&&g.eventSource){g.log("EventSource calling close()");g.eventSource.close();g.eventSource=null;delete g.eventSource}},abort:function(g,h){f.ajaxAbort(g,h)}}}(window.jQuery,window));(function(e,d){var a=e.signalR,b=e.signalR.events,c=e.signalR.changeState,f=a.transports._logic;a.transports.webSockets={name:"webSockets",supportsKeepAlive:true,send:function(g,h){g.socket.send(h)},start:function(h,n,j){var i,m=false,k=this,l=!n,g=e(h);if(!d.WebSocket){j();return}if(!h.socket){if(h.webSocketServerUrl){i=h.webSocketServerUrl}else{i=h.wsProtocol+h.host}i+=f.getUrl(h,this.name,l);h.log("Connecting to websocket endpoint '"+i+"'");h.socket=new d.WebSocket(i);h.socket.onopen=function(){m=true;h.log("Websocket opened");f.clearReconnectTimeout(h);if(n){n()}else{if(c(h,a.connectionState.reconnecting,a.connectionState.connected)===true){g.triggerHandler(b.onReconnect)}}};h.socket.onclose=function(o){if(this===h.socket){if(!m){if(j){j()}else{if(l){k.reconnect(h)}}return}else{if(typeof o.wasClean!=="undefined"&&o.wasClean===false){e(h).triggerHandler(b.onError,[o.reason]);h.log("Unclean disconnect from websocket."+o.reason)}else{h.log("Websocket closed")}}k.reconnect(h)}};h.socket.onmessage=function(p){var q=d.JSON.parse(p.data),o=e(h);if(q){if(e.isEmptyObject(q)||q.M){f.processMessages(h,q)}else{o.triggerHandler(b.onReceived,[q])}}}}},reconnect:function(g){f.reconnect(g,this.name)},lostConnection:function(g){this.reconnect(g)},stop:function(g){f.clearReconnectTimeout(g);if(g.socket!==null){g.log("Closing the Websocket");g.socket.close();g.socket=null}},abort:function(g){}}}(window.jQuery,window));(function(a){a.signalR.version="##VERSION##"}(window.jQuery));